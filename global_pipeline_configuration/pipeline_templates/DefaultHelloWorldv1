//library 'libTest@' + pipelineConfig.keywords.library_version

//build(pipelineConfig.keywords.build_tool)


//def library = jte.libraries
//def buildStep = library.build
//buildStep()
//def spec = pipelineConfig.libraries

//echo "libraries: ${spec}"

import org.jenkinsci.plugins.workflow.flow.FlowExecutionOwner
import org.boozallen.plugins.jte.init.governance.config.dsl.PipelineConfigurationObject
import org.boozallen.plugins.jte.init.governance.config.dsl.PipelineConfigurationDsl

node {


FlowExecutionOwner owner = CpsThread.current().getExecution().getOwner()
PipelineConfigurationDsl dsl = new PipelineConfigurationDsl(owner)
dsl.firstConfig = true


String pipelineConfigurationAsString = readFile("./pipeline_config.groovy")
//PipelineConfigurationProvider.getConfig(owner)


// After this point I cannot do 'sh' or 'writeFile' anymore and it throws: "java.io.NotSerializableException: org.boozallen.plugins.jte.init.governance.config.dsl.PipelineConfigurationDsl"
PipelineConfigurationObject pipelineConfigurationObject = dsl.parse(pipelineConfigurationAsString)
}